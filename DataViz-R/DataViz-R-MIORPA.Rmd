---
title: "Intro to Data Visualization in R"
subtitle: "A gentle, practical start"
author: "OzanEvkaya"
date: "2025-08-12"
output: 
  ioslides_presentation:
    nature:
      ratio: "16:9"
      highlightLines: true
      highlightStyle: solarized-light
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(echo = FALSE, fig.width = 8, fig.height = 5, fig.align = "center")
```

```{r, warning=FALSE, message=FALSE}
library(tidyverse)
```


## Why Visualize

- See patterns, spot anomalies, generate questions. The purpose is to literally *see* what your data seems to say.
- Communicate findings clearly and persuasively.
- Start simple: summaries + visuals. (EDA mindset)
- Human brains are very good at identifying complex patterns ... and similarly they can easily be fooled!

> *"The simple graph has brought more information to the data analyst's mind than any other device." --- John Tukey*

## What is EDA?

- Exploratory data analysis (EDA) is the first step in **understanding** the main features and structures of a data set.
<br>
- Many statistical tools and techniques are used when performing EDA, but crucially they are **simple** to allow the data __speak__ for itself.
<br>
- Tools that a data scientist may use are:
  - Data transformation/wrangling
  - Calculation of simple summary statistics (mean, median, variance, correlation, etc.)
  - Tabulation, Graphical or visual representations

> *"Although we often hear that data speak for themselves, their voices can be soft and sly." --- Mosteller et al. (1983)*

## ggplot2 $\in$ tidyverse

- The most widely used R package for graphics.

```{r echo=FALSE, out.width="30%"}
knitr::include_graphics("ggplot2-part-of-tidyverse.png")
```

- **ggplot2** is tidyverse's data visualization package 
- `gg` in "ggplot2" stands for *Grammar of Graphics* from the book by Leland Wilkinson

## Main layers of the grammer

```{r echo=FALSE, out.width="80%"}
knitr::include_graphics("grammar-of-graphics.png")
```


## Structure of creating a plot

- `ggplot()` is the main function in ggplot2
- Construct plots by _adding_ (`+`) layers -- **Not** the `%>%` pipe!

- Many types of geometries:
  - `geom_points()`, `geom_histogram()`, `geom_line()`, `geom_boxplot()`, etc.

- [ggplot2 cheat sheet](https://www.rstudio.com/resources/cheatsheets/)


## General Usage

```{r, echo = TRUE, eval=FALSE}

ggplot(data = [dataset], # Data 
       # Aesthetics
       mapping = aes(x = [x-variable], y = [y-variable])) +   
  # Geometries
   geom_[*]() +  
  # ...
   other options                                                 
```

## Example: Palmer Penguins

Measurements for penguin species, island in Palmer Archipelago, size (flipper length, body mass, bill dimensions), and sex.

```{r eval=TRUE}
library(palmerpenguins)
glimpse(penguins)

```

## Example: Penguins dataset

```{r penguins, echo = FALSE, fig.align = "center", fig.width = 6, fig.asp = 1, out.width = "50%", warning = FALSE}
penguins <- palmerpenguins::penguins
ggplot(data = penguins, 
       mapping = aes(x = bill_depth_mm, y = bill_length_mm,
                     colour = species)) +
  geom_point() +
  labs(title = "Penguin bill depth & length",
       x = "Bill depth (mm)", 
       y = "Bill length (mm)",
       colour = "Species")
```


## Example: Penguins dataset

```{r, eval = FALSE, echo=TRUE,fig.align = "center", fig.width = 6, fig.asp = 1, out.width = "50%", warning = FALSE}
penguins <- palmerpenguins::penguins
ggplot(data = penguins, 
       mapping = aes(x = bill_depth_mm, y = bill_length_mm,
                     colour = species)) +
  geom_point() +
  labs(title = "Penguin bill depth & length",
       x = "Bill depth (mm)", 
       y = "Bill length (mm)",
       colour = "Species")
```

## And iterate ...

* Editing the aesthetic options: Point colour, size, shape, etc.
* Incorporate more variables from the data set.
* Specify the limits of the co-ordinate axes to zoom in or out.
* Include additional descriptive information: sub-title, caption, data source citation, etc.
* Add other graphical information: line/curve of best fit, arrows, estimation intervals, etc.
* Faceting/panelling multiple plots into a grid.
* Changing the colour pallet that is more accessible for colour blindness.
* ...

**However**, more is not necessarily good - there should be certain design choices 

## Understanding your data

* There are many types of data visualisation, each designed with a particular purpose.
* To determine which visualisation style is appropriate, consider:

  1. What are the properties of variables?
  2. How many variables to include in the data visualisation?
  3. What aspect of the data do you want to explore, investigate and communicate?
  
## Types of variables

- **Quantitative variables** are variables whose data are numerical values.
  - **Discrete variables** describes count data, typically non-negative integer values. <br />
    Eg, Number of IDS students or number of election votes.
  - **Continuous variables** are typically real-valued measurements, rounded to a specified number of decimal places or significant figures. <br />
    Eg, Penguin bill length, body mass and flipper length.

## Types of variables

- **Qualitative variable** are variables that are descriptive.
  - **Categorical (factor) variables** usually identify one option from a small set of cases. <br />
    Eg, Penguin breeds (Adelie, Chinstrap or Gentoo).
  - **Ordinal variables** are categorical variables that have a natural ordering. <br />
    Degree grades: First, upper-second, lower-second and third.

[From Data to Viz](https://www.data-to-viz.com/)

## Number of variables involved

- One variable (Univariate data analysis)
  - What is the _location_, _spread_ and _shape_ of the data?
  - Types of visualisations:**histogram**, **box plot**, **bar chart**, etc.
- Two variables (Bivariate data analysis)
  - Investigating the relationship between two variables. Positive/negative correlation? Linear or non-linear relationship?
  - Types of visualisations: **scatter plot**, **box plots**, **segmented bar plot**, etc.
- Three or more variables (Multivariate data analysis)
  - Investigating the relationship between many variables simultaneously.
  - Use of **colour**, **style** and **faceting** - be creative!
  
## Motivating Data Set: Bats 

* Extracted from the [Atlantic Mammal Traits](https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecy.2106) survey on animal morphology.
* Data contains information about 4334 Neotropical fruit bats (_Aribeus_) from South America between 2010-2017.

```{r load-data, message = FALSE}
bat_data <- read_csv("bats.csv")
glimpse(bat_data)
```


## Data Dictionary

| Variable    | Description | Type |
|:------------|:------------|:-----|
| `species`   | Name of bat species | Categorical (5 cases) |
| `body_mass` | Body mass (in grams)| Numerical, continuous |
| `forearm`   | Forearm length (in mm) | Numerical, continuous |
| `age`       | Adult or Juvenile | Categorical (2 cases) |
| `sex`       | Female or Male | Categorical (2 cases) |
| `year`      | Year of measurement | Numerical, discrete |

## Histogram by default 

```{r message = TRUE, out.width = "50%", fig.height = 5, fig.width = 8, fig.align='center'}
ggplot(data = bat_data, 
       mapping = aes(x = body_mass)) +
  geom_histogram()
```


* Message specifies the use of default/assumed values


## Histogram by certain modifications 

```{r hist-col, echo=FALSE, warning = FALSE}
ggplot(data = bat_data, 
       mapping = aes(x = body_mass)) +
  geom_histogram(
    bins = 30,
    fill = "darkcyan", #<<
    colour = "darkblue"   #<<
    ) +     
  labs(
    x = "Body mass (in grams)",
    y = "Frequency",
    title = "Body mass of fruit bats",
    subtitle = "(2010-2017)"
    ) +
  theme_bw()
```


## Density plot

```{r density-custom, warning = FALSE}
ggplot(data = bat_data, 
       mapping = aes(x = body_mass)) + 
  geom_density(
    fill = "darkcyan"
    ) +   
  labs(
    x = "Body mass (in grams)",
    y = "Density",
    title = "Body mass of fruit bats",
    subtitle = "(2010-2017)"
    ) +
  theme_bw()
```


## Box plot

```{r boxplot, warning = FALSE}
ggplot(data = bat_data, 
       mapping = aes(x = body_mass)) + 
  geom_boxplot( ) +   #<<
  labs(
    x = "Body mass (in grams)",
    title = "Body mass of fruit bats",
    subtitle = "(2010-2017)"
    ) +
  theme_bw()
```


## Adding a categorical variable via aesthetics

```{r density multiple, warning = FALSE}
ggplot(data = bat_data, 
       mapping = aes(
         x = body_mass,
         fill = species   #<<
         )) +
  geom_density(
    alpha = 0.5 #<<
    ) +
  labs(
    x = "Body mass (in grams)",
    y = "Density",
    title = "Body mass of fruit bats,",
    subtitle = "by species" ) 
```

## Via facetings

As a 2x2 setting

```{r grid, warning = FALSE}
ggplot(data = bat_data, 
       mapping = aes(x = body_mass)) +
  geom_histogram(bins = 30) +
  labs(
    x = "Body mass (in grams)",
    y = "Frequency",
    title = "Body mass of fruit bats,",
    subtitle = "by age and sex" )  +
  facet_grid(age ~ sex,       #<<
             scale = "free")  #<<

```


## Data visualisation gallery

* `ggplot2` is used to create a wide variety of data visualisation styles. It has many customisation tools to support your communication.
* Use `ggplot2` manual pages (and online searches) to support your creation.
* Specific starting point would be [R Graph gallery](https://r-graph-gallery.com/)

* **But**, excessive customisation can be distracting.
* Remember the 4 respects: 1. Respect the **people**, 2. Respect the **data**, 3. Respect the **mathematics** and 4. Respect the **computers**
  
## RSS: Best Practices for Data Visualisation

- **[Best Practices for Data Visualisation](https://royal-statistical-society.github.io/datavisguide/)** aims to equip readers with the fundamentals for creating data visualizations that are high-quality, readable, impactful, and accurate in both presentation and interpretation.

- The guide blends both the scientific and creative aspects of visualization — it emphasizes that data viz is not just plotting defaults, but actively telling a story and choosing design elements deliberately to serve that story

- Though primarily aimed at RSS publications (Significance magazine, JRSS Series A, Real World Data Science), the guidance is broadly relevant for any data viz task

*Thanks to Andreas Krause, Nicola Rennie, and Brian Tarran*

## Principles & Choosing Chart Types

To select the right chart type, consider:

1. **Data type** (e.g., numeric, categorical) — tools like *From Data to Viz* use decision trees to suggest suitable chart formats.
2. **Data relationship** (e.g., correlation, ranking, deviation) — platforms like *Visual Vocabulary* guide selection based on the main relationship you want to show

Checklist:

- Be clear on the visualization's purpose.
- Know your audience.
- Choose chart type based on data structure or relationship.
- Refine with audience’s graph literacy in mind

## Styling & Accessibility

Emphasis is placed on styling for **accessibility**, using thoughtful choices in color, annotation, fonts, and alternative text

- **Unstyled** version uses default colors and labels.
- **Styled** version includes readable font sizes, contrast-aware color fills, in-chart labels, and clear titles/subtitles — vastly improving interpretability

Key styling components:

- Accessible color palettes.
- Effective annotations.
- Legible font sizes and styles.
- Alt text for visual inclusion

## Very promising: Lots of ggplot2 extensions 

- 151 registered extensions available to explore
- There are created with the same grammer of graphics approach so that they are following similar syntax behind the scene mostly 
  - Specific packages for specific tasks can be found such as **patchwork**, **gganimate**, **esquisse**, **ggcorplot** etc. 

- Various packages designed for customization and additional theme usage such as **ggthemes**, **ggpubr**
- Some packages are tailored to additional information on top of the visualization such as **ggstatsplot**

## Interactive & Web-Based Visuals

| Package         | Interactivity                | Typical Tasks                         | Standout Strengths                                                                                                  |
| --------------- | ---------------------------- | ------------------------------------- | ------------------------------------------------------------------------------------------------------------------- |
| **plotly (R)**  | Interactive (HTML)           | Dashboards, rich interactive plots    | Supports many chart types—including 3D, contour, maps—and works offline                      |
| **highcharter** | Interactive (JS via R)       | Themed charts, interactive dashboards | Leverages Highcharts JS with professional themes (“economist”, “FT”, “538”)                        |
| **leaflet (R)** | Interactive maps             | Web maps with markers, layers         | R binding for Leaflet.js; great for interactive maps in Shiny/R Markdown |
| **dygraphs**    | Interactive (JS time series) | Time-series charts with brushing      | Handles large time-series efficiently, integrates RColorBrewer palettes                              |                                                |

## Additional Tools & Enhancements

- **gganimate** — Add frame-based animations to plots; treat time as an aesthetic. Ideal for dynamic visual storytelling.
- **ggthemes** — Offers extra pre-designed themes and color scales beyond ggplot2 defaults.
- **ggpubr** — Simplifies the creation of publication-ready plots, especially statistical plots like boxplots, histograms, and violin plots.
- **patchwork** — Aids in composing multiple ggplot2 plots into complex layouts easily.
- **RColorBrewer** – Static; provides beautiful sequential/diverging palettes, enhances maps and plots 
- **Esquisse** – Interactive GUI; drag‑and‑drop to build ggplot2 charts and extract code 
- **GGally** — Extends ggplot2 with tools like ggpairs for easy pairwise plots and correlation matrices.

## Quick Reference: Which to Use When?

- Data transformation pipelines? → tidyverse (especially ggplot2 as the viz endpoint)
- Custom, publication-quality 2D plots? → ggplot2
- Faceted, multivariate plots? → lattice or ggplot2 with suitable faceting
- Browser-based interactive charts? → plotly, leaflet
- 3D interactive graphics, including functions modelled on base graphics → RGL
- Palette design or themes? → ggthemes
- Prefer a GUI to build plots? → Esquisse

## What about the Python world ?

- In my view, R seems still more powerful compared to python 

- However, there is a growing list of python libraries with a community also 

- Let us move to the other document now!


